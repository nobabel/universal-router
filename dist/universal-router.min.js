/*! Universal Router | MIT License | https://www.kriasoft.com/universal-router/ */
!function(e,r){"object"==typeof exports&&"undefined"!=typeof module?module.exports=r():"function"==typeof define&&define.amd?define(r):e.UniversalRouter=r()}(this,function(){"use strict";var e=new RegExp(["(\\\\.)","(?:\\:(\\w+)(?:\\(((?:\\\\.|[^\\\\()])+)\\))?|\\(((?:\\\\.|[^\\\\()])+)\\))([+*?])?"].join("|"),"g"),r=function(e){return e.replace(/([.+*?=^!:${}()[\]|/\\])/g,"\\$1")},t=function(e){return e.replace(/([=!:$/()])/g,"\\$1")},n=function(e){return e&&e.sensitive?"":"i"},o=function(e,r,t){for(var o=[],i=0;i<e.length;i++)o.push(u(e[i],r,t).source);return new RegExp("(?:"+o.join("|")+")",n(t))},i=function(n,o,i){return a(function(n,o){for(var i,a=[],u=0,l=0,s="",c=o&&o.delimiter||"/",p=o&&o.delimiters||"./",f=!1;null!==(i=e.exec(n));){var h=i[0],d=i[1],v=i.index;if(s+=n.slice(l,v),l=v+h.length,d)s+=d[1],f=!0;else{var g="",m=n[l],x=i[2],y=i[3],b=i[4],j=i[5];if(!f&&s.length){var w=s.length-1;p.indexOf(s[w])>-1&&(g=s[w],s=s.slice(0,w))}s&&(a.push(s),s="",f=!1);var R=""!==g&&void 0!==m&&m!==g,O="+"===j||"*"===j,k="?"===j||"*"===j,U=g||c,$=y||b;a.push({name:x||u++,prefix:g,delimiter:U,optional:k,repeat:O,partial:R,pattern:$?t($):"[^"+r(U)+"]+?"})}}return(s||l<n.length)&&a.push(s+n.substr(l)),a}(n,i),o,i)},a=function(e,t,o){for(var i=(o=o||{}).strict,a=!1!==o.end,u=r(o.delimiter||"/"),l=o.delimiters||"./",s=[].concat(o.endsWith||[]).map(r).concat("$").join("|"),c="",p=!1,f=0;f<e.length;f++){var h=e[f];if("string"==typeof h)c+=r(h),p=f===e.length-1&&l.indexOf(h[h.length-1])>-1;else{var d=r(h.prefix),v=h.repeat?"(?:"+h.pattern+")(?:"+d+"(?:"+h.pattern+"))*":h.pattern;t&&t.push(h),h.optional?h.partial?c+=d+"("+v+")?":c+="(?:"+d+"("+v+"))?":c+=d+"("+v+")"}}return a?(i||(c+="(?:"+u+")?"),c+="$"===s?"$":"(?="+s+")"):(i||(c+="(?:"+u+"(?="+s+"))?"),p||(c+="(?="+u+"|"+s+")")),new RegExp("^"+c,n(o))},u=function(e,r,t){return e instanceof RegExp?function(e,r){if(!r)return e;var t=e.source.match(/\((?!\?)/g);if(t)for(var n=0;n<t.length;n++)r.push({name:n,prefix:null,delimiter:null,optional:!1,repeat:!1,partial:!1,pattern:null});return e}(e,r):Array.isArray(e)?o(e,r,t):i(e,r,t)},l=Object.prototype.hasOwnProperty,s=new Map;function c(e){try{return decodeURIComponent(e)}catch(r){return e}}function p(e,r,t,n,o){var i,a,f=0;return{next:function(h){if(e===h)return{done:!0};if(!i&&(i=function(e,r,t,n){var o=!e.children,i=(e.path||"")+"|"+o,a=s.get(i);if(!a){var p=[];a={keys:p,pattern:u(e.path||"",p,{end:o})},s.set(i,a)}var f=a.pattern.exec(r);if(!f)return null;for(var h=f[0],d=Object.assign({},n),v=1;v<f.length;v++){var g=a.keys[v-1],m=g.name,x=f[v];void 0===x&&l.call(d,m)||(g.repeat?d[m]=x?x.split(g.delimiter).map(c):[]:d[m]=x?c(x):x)}return{path:o||"/"!==h.charAt(h.length-1)?h:h.substr(1),keys:t.concat(a.keys),params:d}}(e,t,n,o)))return{done:!1,value:{route:e,baseUrl:r,path:i.path,keys:i.keys,params:i.params}};if(i&&e.children)for(;f<e.children.length;){if(!a){var d=e.children[f];d.parent=e,a=p(d,r+i.path,t.substr(i.path.length),i.keys,i.params)}var v=a.next(h);if(!v.done)return{done:!1,value:v.value};a=null,f++}return{done:!0}}}}function f(e,r){if("function"==typeof e.route.action)return e.route.action(e,r)}var h=function(){function e(e,r){if(void 0===r&&(r={}),Object(e)!==e)throw new TypeError("Invalid routes");this.baseUrl=r.baseUrl||"",this.errorHandler=r.errorHandler,this.resolveRoute=r.resolveRoute||f,this.context=Object.assign({router:this},r.context),this.root=Array.isArray(e)?{path:"",children:e,parent:null}:e,this.root.parent=null}return e.prototype.resolve=function(e){var r=this,t=Object.assign({},this.context,"string"==typeof e?{pathname:e}:e),n=p(this.root,this.baseUrl,t.pathname.substr(this.baseUrl.length),[],null),o=this.resolveRoute,i=null,a=null,u=t;function l(e,r,s){void 0===r&&(r=i.value.route);var c=null===s&&i.value.route;if(i=a||n.next(c),a=null,!e&&(i.done||!function(e,r){for(var t=r;t;)if((t=t.parent)===e)return!0;return!1}(r,i.value.route)))return a=i,Promise.resolve(null);if(i.done){var p=new Error("Page not found");return p.context=t,p.code=404,Promise.reject(p)}return u=Object.assign({},t,i.value),Promise.resolve(o(u,i.value.params)).then(function(t){return null!==t&&void 0!==t?t:l(e,r,t)})}return t.next=l,Promise.resolve().then(function(){return l(!0,r.root)}).catch(function(e){if(e.context=e.context||u,e.code=e.code||500,r.errorHandler)return r.errorHandler(e);throw e})},e}();return h.pathToRegexp=u,h});
//# sourceMappingURL=universal-router.min.js.map
